<Page xmlns="http://www.nativescript.org/tns.xsd"
      xmlns:g="components/grid-view/grid-view"
      xmlns:c="components/pie-chart/pie-chart"
      loaded="pageLoaded"
      navigatingTo="navigatedTo" >

  <GridLayout rows="auto, auto, auto, auto, *, auto">
    <GridLayout columns="*, auto">
      <Label text="{{ report.Title }}" textWrap="true" cssClass="title" />
      <Label col="1" text="{{ totalCost | formatCurrency }}" cssClass="total" />
    </GridLayout>
    <Label row="1" text="{{ report.BusinessPurpose }}" cssClass="subTitle" />
    <Label row="2" text="{{ report.Date | formatDate }}" cssClass="subTitle" />

    <c:PieChart id="PieChart" row="3" valueProperty="Percent" canSelect="true" labelProperty="Category" showLabels="true" cssClass="categoriesChart" items="{{ expensesByCategory }}" />

    <ListView row="4" items="{{ expenses }}" itemTap="expenseTap" cssClass="expensesListView">
      <ListView.itemTemplate>
        <GridLayout columns="auto, *, auto">
          <Border backgroundColor="{{ categoryColor }}" cssClass="category" />
          <StackLayout col="1" marginLeft="5">
            <Label text="{{ expense.Title }}" cssClass="itemTitle" />
            <Label text="{{ expense.Date | formatDate }}" cssClass="itemSubTitle" />
            <Label text="{{ expense.Location }}" cssClass="itemSubTitleLast" />
          </StackLayout>
          <Label col="2" text="{{ expense.Cost | formatCurrency }}" cssClass="itemCost" />
        </GridLayout>
      </ListView.itemTemplate>
    </ListView>

    <AbsoluteLayout rowSpan="6" cssClass="fabContainer" visibility="{{ fabVisibility }}" >
      <Image src="res://fab" tap="addExpenseTap" stretch="none" cssClass="fab" />
    </AbsoluteLayout>

    <GridLayout row="5" columns="auto, *" tap="addExpenseTap" cssClass="imageButtonContainer" visibility="{{ addExpenseButtonVisibility }}">
      <Image src="res://add-white" stretch="none" cssClass="imageButtonIcon" />
      <Label col="1" text="Add expense" cssClass="imageButtonText" />
    </GridLayout>

    <ActivityIndicator rowSpan="6" busy="{{ isLoading }}" />
  </GridLayout>
</Page>