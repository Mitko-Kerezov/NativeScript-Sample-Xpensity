<Page xmlns="http://www.nativescript.org/tns.xsd"
      xmlns:g="components/grid-view/grid-view"
      xmlns:c="components/pie-chart/pie-chart"
      ios.title="My reports"
      navigatedTo="navigatedTo" >
  <TabView id="TabView">
    <TabView.items>
      <TabViewItem id="ReportsTabItem" iconSource="res://ic_reports" >
        <TabViewItem.view>
          <GridLayout rows="auto, *" bindingContext="{{ reportsViewModel }}" >
            <Label text="MY REPORTS" cssClass="header" visibility="{{ androidVisibility }}" />

            <ScrollView row="1" >
              <g:GridView items="{{ reports }}" gridColumns="2" cssClass="reportsGrid" itemTap="reportTap">
                <g:GridView.itemTemplate>
                  <Border cssClass="tile" >
                    <StackLayout orientation="vertical">
                      <c:PieChart valueProperty="Percent" labelProperty="Category" cssClass="categoriesChart" items="{{ expensesByCategory }}" />
                      <Label text="{{ report.Title }}" cssClass="itemTitle" />
                      <Label text="{{ report.Date | formatDate }}" cssClass="itemSubTitleLast" />
                    </StackLayout>
                  </Border>
                </g:GridView.itemTemplate>
              </g:GridView>
            </ScrollView>

            <AbsoluteLayout rowSpan="2" cssClass="fabContainer" visibility="{{ androidVisibility }}" >
              <Image src="res://fab" tap="addReportTap" stretch="none" cssClass="fab" />
            </AbsoluteLayout>

            <ActivityIndicator rowSpan="2" busy="{{ isLoading }}" />
          </GridLayout>
        </TabViewItem.view>
      </TabViewItem >
      <TabViewItem iconSource="res://ic_notifications" >
        <TabViewItem.view>
          <GridLayout rows="auto, auto, *" bindingContext="{{ notificationsViewModel }}">
            <Label text="NOTIFICATIONS" cssClass="header" />

            <Border row="1" cssClass="blockContainer">
              <StackLayout orientation="horizontal">
                <Label text="{{ reportsForApproval }}" cssClass="blockLabel" />
                <Label margin="16 0 16 0" text=" REPORT(S) WAITING FOR APPROVAL" cssClass="blockLabel" />
              </StackLayout>
            </Border>

            <ActivityIndicator rowSpan="3" busy="{{ isLoading }}" />
          </GridLayout>
        </TabViewItem.view>
      </TabViewItem >
      <TabViewItem iconSource="res://ic_settings" >
        <TabViewItem.view>
          <GridLayout rows="auto, *" bindingContext="{{ settingsViewModel }}">
            <Label text="SETTINGS" cssClass="header" />

            <ScrollView row="1">
              <StackLayout>
                <Border cssClass="blockContainer">
                  <Label text="{{ name }}" cssClass="blockLabel" />
                </Border>

                <GridLayout columns="*, auto">
                  <Label text="Offline Mode" />
                  <Switch col="1" checked="{{ offlineMode }}"/>
                </GridLayout>

                <!--<GridLayout columns="*, auto">
                  <Label text="Notifications" />
                  <Switch col="1" checked="{{ notifications }}"/>
                </GridLayout>-->

                <Button text="LOGOUT" tap="logoutButtonTap" cssClass="secondaryButton" />
              </StackLayout>
            </ScrollView>

            <ActivityIndicator rowSpan="2" busy="{{ isLoading }}" />
          </GridLayout>
        </TabViewItem.view>
      </TabViewItem >
    </TabView.items>
  </TabView>
</Page>